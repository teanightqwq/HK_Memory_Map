# 管理员功能使用说明

## 🔒 管理员权限系统

### 默认管理员账号

系统已内置两个测试管理员账号：

1. **超级管理员**
   - 用户名：`admin`
   - 密码：`admin123456`
   - 权限：完整的系统管理权限

2. **审核员**
   - 用户名：`reviewer`
   - 密码：`review123456`
   - 权限：图片审核权限

### 访问管理后台

1. 访问管理员登录页：`pages/admin/login.html`
2. 使用上述账号登录
3. 成功后会跳转到仪表板

## 📊 管理员功能

### 1. 数据总览（Dashboard）
- **路径**：`pages/admin/dashboard.html`
- **功能**：
  - 查看用户总数、活跃用户数
  - 查看提交总数、待审核数量
  - 查看碎片和卡片统计
  - 用户增长趋势图表（最近7天）
  - 分类分布饼图
  - 最近活动记录

### 2. 图片审核（Review）
- **路径**：`pages/admin/review.html`
- **功能**：
  - 查看所有待审核提交
  - 按分类筛选（餐饮/文化/建筑）
  - 搜索功能（标题、描述、用户名）
  - **批准操作**：
    - 点击"✓ 批准"按钮
    - 系统自动生成记忆碎片奖励给用户
    - 更新用户统计数据
    - 记录审核日志
  - **拒绝操作**：
    - 点击"✗ 拒绝"按钮
    - 可输入拒绝理由
    - 记录审核日志
  - **查看详情**：
    - 点击"👁 查看详情"查看大图
    - 在弹窗中也可直接批准/拒绝

### 3. 权限控制
- **角色层级**：
  - `super_admin`（超级管理员）：最高权限 = 3
  - `reviewer`（审核员）：审核权限 = 2
  - `viewer`（查看员）：只读权限 = 1
  
- **自动验证**：
  - 访问管理页面时自动验证登录状态
  - 未登录自动跳转到登录页
  - 权限不足自动跳转到仪表板

## 🎯 审核流程

### 用户提交照片流程
1. 用户在前台上传照片（`pages/upload.html`）
2. 照片状态设为 `pending`（待审核）
3. 存储在 `localStorage.submissions` 中

### 管理员审核流程
1. 管理员登录后台
2. 进入审核页面查看待审核列表
3. 点击查看详情了解提交内容
4. 决定批准或拒绝：

**批准后自动执行：**
- 提交状态改为 `approved`
- 生成对应分类的记忆碎片
- 碎片自动添加到用户收藏
- 用户统计 +1 碎片
- 记录审核日志

**拒绝后执行：**
- 提交状态改为 `rejected`
- 记录拒绝理由
- 记录审核日志
- 用户不获得碎片

## 💾 数据存储结构

### 管理员数据
```javascript
// localStorage.admins
[
  {
    id: 'admin-001',
    username: 'admin',
    password: 'admin123456',
    email: 'admin@hkmemory.com',
    role: 'super_admin',
    createdAt: '2025-11-10T...'
  }
]
```

### 管理员会话
```javascript
// localStorage.adminSession 或 sessionStorage.adminSession
{
  id: 'admin-001',
  username: 'admin',
  email: 'admin@hkmemory.com',
  role: 'super_admin',
  loginTime: '2025-11-10T...'
}
```

### 审核日志
```javascript
// localStorage.reviewLogs
[
  {
    id: 'log-1699999999999',
    submissionId: 'sub-xxx',
    action: 'approved', // 或 'rejected'
    reason: '', // 拒绝时填写
    reviewer: 'admin',
    reviewTime: '2025-11-10T...'
  }
]
```

## 🔐 安全说明

⚠️ **重要提示**：当前系统是纯前端原型，所有数据存储在浏览器 localStorage 中。

**生产环境部署时需要：**
1. 实现后端 API 进行身份验证
2. 密码使用哈希加密存储（bcrypt/argon2）
3. 使用 JWT 或 Session 管理登录状态
4. 实现 CSRF 保护
5. 添加验证码防止暴力破解
6. 实现操作日志审计
7. 图片存储到服务器而非 Base64

## 📝 快速测试

### 测试审核功能

1. **准备测试数据**：
   - 先用普通用户账号登录（demo/123456）
   - 上传几张照片
   - 退出登录

2. **管理员审核**：
   - 访问 `pages/admin/login.html`
   - 使用 admin/admin123456 登录
   - 进入"审核提交"页面
   - 应该能看到刚才上传的照片

3. **批准照片**：
   - 点击"✓ 批准"
   - 确认提示框
   - 成功后照片从列表消失

4. **查看结果**：
   - 退出管理员账号
   - 重新用 demo/123456 登录
   - 进入"我的收藏"页面
   - 在"记忆碎片"标签下应该能看到新获得的碎片

## 🎨 界面特点

- **侧边栏导航**：固定在左侧，深色主题
- **数据卡片**：清晰展示各项统计数据
- **审核列表**：卡片式布局，含图片预览
- **图表可视化**：简单的条形图和进度条
- **响应式设计**：适配不同屏幕尺寸
- **消息提示**：操作成功/失败的即时反馈

## 🚀 未来扩展

可以继续添加的功能：
- 用户管理（封禁、删除用户）
- 碎片管理（手动发放、回收）
- 分类管理（添加新分类和子分类）
- 系统设置（修改规则、配置参数）
- 批量操作（批量审核）
- 数据导出（Excel/CSV）
- 更丰富的图表（使用 Chart.js）
